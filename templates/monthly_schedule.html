{# templates/monthly_schedule.html #}
{% extends "base.html" %}
{% block title %}Monthly Schedule ‚Äî NewTon{% endblock %}

{% block head_extra %}
  {# DEV ONLY: Tailwind CDN. Remove in production and include compiled tailwind CSS instead. #}
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/css/schedule.css">
{% endblock %}

{% block content %}
  <header class="max-w-6xl mx-auto px-4 md:px-6 pt-6 md:pt-8 pb-4">
    <div class="flex items-start md:items-center gap-4 flex-col md:flex-row">
      <div class="flex-1">
        <h1 class="text-3xl md:text-4xl font-bold tracking-tight text-slate-50">üìÖ Monthly Goals Timeline</h1>
        <p class="text-slate-300 mt-2">
          Auto-highlighted for <span id="currentMonthLabel" class="font-semibold text-emerald-300">current month</span>.
        </p>
      </div>
      <div class="flex gap-2">
        <button id="refreshBtn" class="glass rounded-xl px-4 py-2 text-sm hover:ring-2 ring-violet-500 text-slate-100">Refresh</button>
      </div>
    </div>
  </header>

  <section class="max-w-6xl mx-auto px-4 md:px-6 sticky-filters">
    <div class="glass rounded-2xl p-4 md:p-5 text-slate-100">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4 items-center">
        <div class="flex gap-3 items-center">
          <label class="text-sm text-slate-300 shrink-0">Goal</label>
          <select id="goalFilter"
                  class="w-full glass rounded-xl px-3 py-2 text-sm text-slate-100 bg-slate-900/70
                         focus:outline-none focus:ring-2 ring-violet-500"></select>
        </div>

        <div class="flex gap-3 items-center">
          <label class="text-sm text-slate-300 shrink-0">Month</label>
          <select id="monthFilter"
                  class="w-full glass rounded-xl px-3 py-2 text-sm text-slate-100 bg-slate-900/70
                         focus:outline-none focus:ring-2 ring-violet-500"></select>
        </div>

        <div class="flex items-center gap-3">
          <input id="searchBox" placeholder="Search tasks‚Ä¶"
                 class="w-full bg-transparent glass rounded-xl px-3 py-2 text-sm text-slate-100
                        focus:outline-none focus:ring-2 ring-violet-500" />
          <button id="clearSearch" class="hidden text-xs px-3 py-2 rounded-lg bg-slate-800/60 hover:bg-slate-800 text-slate-200">Clear</button>
        </div>
      </div>

      <div id="legend" class="mt-4 flex flex-wrap gap-2 text-xs"></div>
    </div>
  </section>

  <section class="max-w-6xl mx-auto px-4 md:px-6 pt-4">
    <div id="summaryStrip" class="glass rounded-2xl p-4 md:p-5 text-slate-200 flex flex-wrap gap-4 text-sm"></div>
  </section>

  <main class="max-w-6xl mx-auto px-4 md:px-6 py-6 md:py-8">
    <div id="timeline" class="relative timeline pl-10 space-y-6"></div>
    <div id="emptyState" class="hidden glass rounded-2xl p-8 text-center text-slate-300">
      <p class="text-lg mb-2">No matching tasks.</p>
      <p class="text-sm">Try clearing the search or selecting a different month/goal.</p>
    </div>
  </main>

  <footer class="max-w-6xl mx-auto px-4 md:px-6 pb-12 text-sm text-slate-400">
    NewTon ‚Äî AI Powered Scheduler. Built with ‚ù§Ô∏è using Flask & TailwindCSS.
  </footer>
{% endblock %}

{% block body_extra %}
  <script>
    // Items from Flask (2D or objects); the JS reads window.ITEMS
    window.ITEMS = {{ items|tojson|safe if items is defined else '[]' }};
  </script>
  <script src="/static/js/schedule.js"></script>
{% endblock %}
